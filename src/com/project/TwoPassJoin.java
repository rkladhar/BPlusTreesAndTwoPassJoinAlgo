package com.project;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

public class TwoPassJoin
{
    //Virtual Disk
    private List<int[]> R = new ArrayList<>();
    private List<int[]> S = new ArrayList<>();
    private List<int[]> finalRelation = new ArrayList<>();
    List<List<int[]>> SBlocks = new ArrayList();
    List<List<int[]>> RBlocks = new ArrayList();
    List<List<int[]>> SBuckets = new ArrayList();
    List<List<int[]>> RBuckets = new ArrayList();

    public void generateRelationS()
    {
        int[] columnB = {12253,16171,44197,10909,10341,30450,12579,23355,18324,49985,49150,43726,19528,14696,47108,32668,38888,49452,17436,16090,38306,32232,22194,39808,24356,43929,32480,11486,22635,49067,15756,30340,27683,43306,43300,22238,47388,21043,33405,19902,33475,36445,19496,32351,14525,24147,15797,13546,25397,17239,45205,47577,24299,44619,34725,12609,36809,14633,49018,35202,44628,40181,17190,49213,45790,15388,12229,15466,22075,44218,11506,22814,14993,44780,13291,23970,23471,44754,11494,27460,20757,20434,42529,16949,45361,12042,33759,42693,17799,35734,36426,21943,29740,39176,20814,21078,10337,41461,22620,47643,46398,49743,10031,29895,41825,48787,11052,24255,48527,26747,48888,23495,18038,44748,21765,22836,11172,15372,46125,33453,24129,19885,32182,16960,41418,11661,37785,46317,35264,27547,46598,32985,22201,22072,42645,24654,49763,39017,16107,11983,17798,38919,40499,16911,20217,38954,24451,38758,43718,29441,28575,44066,19292,49432,46961,36808,44999,41706,39586,27317,38033,31740,46412,13568,34521,40335,47663,30768,25853,19173,32030,46144,18576,42078,47539,13705,38910,27368,16849,25580,39196,31710,27473,38822,11226,23289,44743,42539,13100,22396,26494,45351,42282,13560,45239,26378,29271,15188,14594,28612,11159,15019,43489,27840,28289,46382,47968,45052,45094,35242,40084,28300,20736,16986,47208,25682,14395,36394,45662,44351,43734,43399,36862,46665,31391,35115,49639,26275,18493,23541,17700,30743,20908,47084,36321,30898,12287,26249,20938,34612,10736,13582,19718,24011,33352,47902,10533,31144,49386,36896,15828,48201,32126,19313,11891,13314,14135,41375,32632,20445,33309,11483,33536,38929,41174,40690,49276,32256,12915,39775,19720,36261,49584,12179,35503,31492,20395,29238,22460,44713,17169,29037,24434,22107,20366,22586,49987,20551,13341,14175,16117,15142,12414,28148,32784,12550,44511,12234,15156,18957,45019,15193,26021,49560,22117,22999,30614,14351,38988,14211,28990,32699,49075,11398,47848,40645,19844,49356,49453,37441,10269,37675,16454,40521,47850,29577,21989,41132,29095,22856,22277,14678,47009,42677,36031,10681,28908,45043,23997,46133,41862,30701,29594,15736,12506,42533,31485,19236,49554,47122,28040,48695,35211,45367,15401,40022,43147,48974,20505,41538,16221,15761,17954,30460,36868,22690,12192,14904,43600,33281,32684,18302,19669,10905,14035,13525,31035,48631,48894,46768,31111,46902,48705,18684,30284,49744,19745,16892,19582,35763,18437,46921,34373,48458,30510,46601,47233,46386,18548,44693,43422,27005,14737,47495,27580,34658,40313,40726,15699,11815,39996,13570,24705,49738,46523,46063,13078,14435,15742,25634,37665,14519,38746,45940,29109,32419,22485,20490,45422,43758,32344,40576,39784,48191,40308,48590,41956,35204,20116,14883,17733,17537,40741,36206,38117,31218,22434,47023,46539,43444,18030,40601,43520,29116,48348,19251,38507,46831,28830,23391,22875,10709,41460,13073,42843,18086,38534,37407,34262,38863,36722,37698,35374,11727,38470,23395,48900,14408,11516,10017,31075,26386,27226,19753,49119,22324,11029,34360,12024,21575,43852,22236,39556,38789,40641,46188,30525,24898,16680,45270,21726,47391,32659,27204,34191,32848,39827,11142,40269,24223,27658,48265,17294,11270,21701,13830,47258,16373,14676,45700,17107,38883,11219,29526,20350,16088,45994,19547,37469,47109,36479,17155,29975,44964,34744,28842,33971,28740,44596,19826,25705,48212,37584,28060,32832,40417,20479,43972,23799,40611,40605,48430,17123,30337,42701,41893,40363,20965,43312,49623,11613,35231,24733,11028,17981,17195,28980,46955,14754,40879,29631,14736,13015,23981,45506,33973,40390,49721,16180,42853,49613,10758,45418,18826,37009,12178,35867,48587,15704,20095,18563,19692,36105,31108,34882,18465,47731,21800,39027,33679,42790,13003,33413,44388,35444,41107,14440,44136,31866,17903,43644,36152,24557,19848,34747,17039,47390,44548,40505,49970,40463,33900,40648,34739,23172,18263,29792,26325,32080,49025,43361,44837,41753,24715,49655,28966,39949,27015,25362,15337,49024,16936,19656,39186,38428,17441,10540,47520,47382,29622,29230,49175,41495,35691,18525,38435,45020,34372,16952,26956,12342,41553,12259,34286,32951,28956,32707,43051,32236,41683,40275,32873,19602,46162,26047,17548,18516,13356,49151,10342,40917,44979,45115,33128,42130,24413,15545,45624,16488,28780,32477,49166,42349,34161,26755,47780,13298,14201,48690,19980,39939,49597,24754,24256,48193,30655,49671,48956,28132,11596,40968,25916,24405,32291,47038,47656,19794,34523,24600,24035,48579,34649,33584,24997,49965,15346,15702,23732,49060,45654,35947,15012,38177,27938,35053,18418,24486,15816,49660,43702,33825,16729,26752,30461,16258,33670,35433,36932,33237,11990,21821,12303,21281,35788,21416,32010,29227,20642,10078,22931,29561,40876,26426,11417,40326,18640,45887,20860,29839,49325,12221,10626,29854,46719,21375,35501,39228,10317,48426,44898,15942,41626,16758,26904,23073,39427,40658,34276,40826,13924,36715,48573,48164,47875,35514,10470,31713,26874,13744,19265,30649,18861,23804,40015,33984,17462,47612,10551,21081,18150,10471,15746,31594,35284,26828,35818,31327,26751,45280,15801,33499,44759,14698,11160,22122,37693,47339,32581,24085,13851,42482,17364,46976,36975,37487,33749,45041,20614,11534,38113,44359,48165,21559,24518,19187,18215,27815,44458,42208,23271,40494,19355,37373,34172,38554,21068,44623,29633,12730,23891,44602,22402,20644,30306,13899,32627,10155,15686,17319,45870,40141,27484,39494,44800,28607,43188,17395,41873,47892,40445,39107,27546,40794,25563,32897,15626,32298,39658,23940,47408,45551,44911,23338,45458,27448,31047,18998,20802,22098,43450,39283,21338,24444,32257,18092,31683,39762,39382,33925,43185,38609,25048,20941,39442,22045,43549,16534,30990,21212,19016,27393,35157,21323,31798,30875,23390,29343,11605,42634,23054,35418,14715,14659,16909,41505,43095,37190,14941,26679,38440,24622,49948,29678,13719,40245,21244,39749,42301,40582,45307,19021,12515,38057,31812,47587,44125,37548,28885,29481,24900,37755,46098,32506,43858,40504,25521,16099,26414,37451,23335,48171,46914,46563,16815,18633,11322,33058,37831,10938,35287,15969,10854,19702,47405,18734,39750,45283,35086,32114,21495,14295,13883,43765,31828,29621,32060,48784,39350,37004,40068,48931,42255,21616,29272,46469,10414,29438,13405,21607,39816,13118,18930,20421,35998,13183,33565,30420,46480,47101,40721,43876,24519,44827,15469,20340,30561,17631,38046,21708,44939,16335,26076,32768,48530,38327,23173,36582,26731,13060,12800,30997,22845,15640,25789,13420,44587,15296,34668,49606,30227,19504,14331,20097,35426,41035,25647,35006,20811,37018,11285,40618,24396,37687,20539,20921,13597,45039,43365,24749,47929,16889,32285,30836,35322,35227,12174,39910,36672,21562,12585,26343,38265,47996,32414,19135,33085,46348,39343,38925,13858,14581,20656,36735,16225,28003,36395,13748,38444,17455,39599,18968,17183,39210,45712,40528,26832,34480,36944,25980,35421,41951,10498,47652,48373,38119,48935,21686,22992,26075,10803,43700,28722,40926,41284,22323,42969,12487,30769,14731,48418,31723,44437,43992,23169,43023,39690,42655,28402,18619,48234,16705,13679,15475,35234,48247,10784,48417,26130,13868,29977,26366,30515,18456,11012,32222,15031,14871,46696,16608,34765,43473,41917,11037,31898,35561,41881,24771,40536,41269,12997,23011,40003,15214,40665,25810,24834,49682,37875,26864,36018,14684,30511,47384,28050,26542,42881,16274,31477,29421,41743,43271,36158,16826,34894,22703,26464,34598,16253,48262,18517,16759,10227,18950,33962,47398,12773,15953,17216,21366,10049,11173,15042,11680,10141,27783,29364,39700,47277,27562,17224,41373,12858,16630,21024,29172,26411,23667,23522,40594,47065,31101,10413,10025,25533,33275,25239,36340,39943,41992,13742,27697,21152,12546,39140,11746,36573,24232,22641,49340,17371,37367,22195,25263,43429,11140,10558,19895,43236,40235,14437,25942,46533,41782,14233,38691,20130,17090,31980,35069,18078,15673,48548,38106,12412,30921,38575,44652,17989,32157,27141,20785,37289,36816,22230,33495,46641,16505,37263,38796,30563,26415,25951,18194,40704,27572,13317,47979,30509,19436,18132,45450,47897,46178,10717,33030,10539,12094,45372,22983,49924,18355,16715,43221,42285,13694,13919,36576,20132,16944,48948,41757,17496,29318,40492,45055,37183,17635,37719,30238,43165,29234,19484,34460,30027,34468,42762,22644,23116,28361,37394,32350,44724,30667,37669,27354,35765,33535,35040,36292,21797,34514,30036,35327,48282,21511,38437,42896,47844,49185,40353,13682,15101,41027,42937,40707,11083,11473,49148,39544,11611,36036,28102,34250,21600,46426,37439,44332,33077,36358,15884,46595,28400,12707,26226,45861,30139,39563,39616,13151,46496,14874,38745,15776,49616,31720,39876,26022,22093,25861,48640,12065,26619,31599,11699,40554,30632,10547,19115,23334,32416,36396,16040,16172,23275,13026,47323,25298,37457,40431,43471,45296,48551,37063,40408,40004,15222,23660,23067,11257,18095,36506,34033,49311,21560,16042,19555,23580,28277,13722,28391,24625,12066,16039,48541,14677,48532,14949,21180,48357,35388,41123,47470,40324,35778,47446,13959,40070,28124,20681,44521,27026,26984,27548,31947,42375,25685,44658,25884,48915,28309,27650,31963,48605,48995,36717,45583,45008,24656,43757,12755,25210,48054,12047,39654,19540,22271,42010,23353,34352,35341,11462,16203,40839,18745,23629,22386,14728,25272,13667,23378,12523,33667,34222,17293,21806,38422,44545,17836,23282,38099,35999,25380,32215,10285,21177,38757,42925,17622,21418,48671,31241,41365,42097,35219,39597,27965,48428,14634,43427,31703,12898,14570,39219,21861,33958,43510,22631,22822,29616,20454,35591,21326,46346,43204,39822,38765,21075,10731,11641,48393,49140,32470,33799,32953,25744,36668,11126,46626,23048,44773,45766,43249,36137,41654,19472,43465,37766,29747,13425,45957,46137,38766,45359,38858,22222,15996,41332,46531,43561,41070,31228,19345,33356,30948,38581,27622,12245,37442,12444,28687,31958,23919,43469,40776,41719,14033,18042,30659,28002,49011,19405,10068,33038,28365,12992,45510,15579,43731,46565,40117,45511,43387,24192,44637,37482,11659,13296,20410,10448,41801,26354,23792,26840,10301,18635,43393,40882,13140,30671,35722,28997,43411,26373,45142,40106,27617,18444,38218,24940,12129,24655,10467,34365,35436,18994,20950,10064,37956,45387,45068,35178,35016,16064,45812,14774,47743,19324,34153,13893,20240,41912,11851,11192,21352,12845,34738,19214,45950,40202,33696,39013,39313,23547,22167,10699,27501,35637,15151,23040,35621,38015,27098,22227,41583,38065,22444,39096,34832,31441,19109,23604,12396,38094,49094,36965,20081,38976,38186,25228,45349,16646,31581,48483,41319,46989,11864,44500,11811,32481,46007,49867,33355,42037,16526,19424,40684,35869,47870,39132,11574,32217,19934,45523,32533,49104,49431,35456,15805,38272,41340,42729,45888,48909,28672,29379,43071,41528,41338,42737,48239,44510,35303,12173,16250,34061,15762,40018,23976,12072,24417,16741,38687,17510,14666,23019,32455,40996,14231,40833,32333,44089,14692,24635,12986,40352,37489,26729,24220,48692,21448,46684,30884,48753,26698,18668,37336,15279,44513,17533,22086,15716,24849,36535,40272,36820,47811,15876,16755,35203,26816,49750,16321,48859,41556,41345,18258,27629,12960,26396,29688,41494,35275,14974,44294,37945,36230,20367,28658,47013,37511,17603,14686,45126,40156,32363,25161,49676,19684,49254,34504,15238,27294,46916,18224,16178,31194,47597,21922,27438,23340,35810,17244,38132,32050,42810,49551,46636,26516,19162,31895,30908,23325,37932,45905,49045,33297,12548,13635,35220,33604,14950,49945,49489,16002,32043,10304,10221,42805,19728,32374,13856,33311,15802,45072,43999,36637,39241,33661,12106,29979,21711,48834,17330,13199,13234,17695,15651,20067,12835,47304,38853,38741,11937,16531,27197,21471,26717,15869,42766,49846,17860,15320,47039,12623,13300,23853,44223,27314,19539,23588,15006,16148,26786,32160,25377,32801,40848,34550,29540,17505,20478,35379,33909,16301,36145,31068,43586,21501,44033,36424,31001,33342,45196,11107,39355,36350,27462,23688,17030,40831,44410,12492,36024,27076,35140,47340,16224,20289,28698,43072,26502,45936,12404,25732,31135,45980,39641,28257,34187,34385,49854,40583,45770,35862,13011,39117,14342,44696,14262,16794,16285,31074,48381,48198,17268,23750,39394,46431,37504,43391,28320,11774,18498,36755,38014,40414,42047,48842,11325,23782,34840,25497,19736,49698,43507,45683,41022,26301,19509,49533,36652,40796,21080,39483,36263,41287,40812,15270,34062,37926,14587,17460,46248,45386,15978,40450,34436,42877,19566,39347,15348,37829,31326,19497,27718,45163,49010,45166,21938,49497,35453,10334,46707,10683,15754,48648,32835,34328,13816,14552,47601,31824,46425,34897,37532,27288,26678,39729,46432,11409,21292,33268,48847,18748,25425,19626,32485,33278,15821,13436,13501,35330,24931,16663,11098,11905,41690,15565,20900,38041,38763,39333,19343,15967,14222,17069,45658,27278,17163,19581,43713,46850,39016,43090,14887,43951,39501,25308,23597,22210,24678,21203,46177,26946,44722,48830,35136,44131,41515,20686,13322,44292,46498,38081,33345,18709,48589,45878,47301,12562,34065,25338,43659,27778,35954,26837,16037,22182,10506,31338,17096,39439,20526,42852,33686,19255,48906,39356,12236,14002,10720,39282,17362,42549,19994,11975,23376,25721,41089,21827,38188,31726,23934,18172,13764,19878,49198,33078,23618,23723,11921,43463,36337,21130,49374,13411,31633,38788,38396,46824,24446,37422,34081,17000,16590,28304,46838,12149,14550,43955,47047,28513,35961,40062,44655,27027,29462,15714,44345,13549,22196,15181,45569,39657,24333,32486,40633,15701,48732,36033,15074,30088,14183,11973,35404,22065,15281,37881,30582,39039,49344,42163,47126,33380,29006,26892,41476,15303,23536,11225,43209,20887,25549,49622,16297,12882,18579,44334,20659,40128,34273,31919,30846,29548,29476,15138,22346,22667,12939,13973,12435,16372,32665,40972,41701,44991,29353,28996,11620,20693,25187,14512,17715,35804,18128,15286,31879,14466,15343,36954,36528,49494,20735,14421,45553,26054,44606,24171,12377,14022,12485,30559,20169,42079,40874,36404,35850,14528,49932,27912,16304,17500,16367,12278,48982,11514,25300,17498,44243,15547,40800,49710,13914,37773,13842,10217,29783,47575,42110,19199,35267,18140,49149,11311,46760,41468,42534,33215,41122,10424,35198,36766,26782,18758,21274,14205,29627,30636,18843,26520,37278,33673,45676,25222,30630,24638,37227,47058,38497,41233,41919,45938,27961,38216,38390,47396,25935,11742,47702,43115,48979,42908,27164,19798,42778,23595,37660,34692,23594,20275,35885,27361,45955,24672,15580,48412,39550,12674,21306,21447,47129,25458,47083,14506,30546,30418,45332,43408,11488,24670,47509,43910,17164,11768,12847,36874,34509,22835,23233,22004,29145,31182,32065,34539,30279,40993,23197,28562,45566,39299,30181,39022,42573,11260,33630,43831,45323,32871,16437,17630,21908,12493,14138,26171,38274,28141,17589,41180,23749,12180,23024,32663,25927,27628,33526,23933,24165,16645,40197,39536,13147,10433,48943,28700,21994,32843,40625,46361,25962,48214,22574,45408,21833,13304,42997,44167,12230,46552,30708,15113,21355,45974,39048,18992,16068,35166,16030,30904,25491,34269,31355,45968,45184,25633,43652,47694,27584,15658,38436,24844,39328,23717,17133,42214,16523,16634,11893,28190,21206,29677,46624,35679,17127,42603,37281,47197,26191,36610,21157,23696,27828,48513,45563,30086,20852,42571,46770,34433,41407,43077,19444,45110,24432,31410,21676,13712,19248,42051,12165,30400,41196,12648,30122,25734,20117,31123,17863,16075,32988,48621,36641,16542,17209,11161,49915,43304,37238,44156,49691,20688,19884,33744,46758,47995,36907,43152,29322,39660,47638,44376,47196,45914,34693,11775,25337,45733,46392,14490,45755,32166,49917,46591,26043,33806,26881,18344,45844,49570,41242,38840,20264,26393,20972,47234,19634,35017,47240,38933,32602,48358,22922,46693,34723,39434,19803,14619,13294,13820,21224,29061,24039,22691,19799,39339,49001,22830,41547,11365,30199,31175,38089,28715,17633,49984,18842,33893,33757,28339,44509,40270,13934,24580,26909,30631,12162,19446,42008,44056,11996,45626,38553,49837,25966,21004,44967,40482,31285,38661,48619,36127,15674,19440,15389,25573,27945,15256,41584,44391,45550,40559,25130,28063,42319,23482,44007,47554,29847,49950,27687,47256,13832,31236,12661,35265,22871,34686,13230,48202,27276,22303,33897,35432,33791,46286,11717,44654,36484,13102,29810,49503,48143,40817,26404,43069,34564,35240,34530,37055,11195,33127,22333,12697,47760,35698,43559,33944,10426,39323,32695,11502,12147,18936,13860,43548,49727,30379,17687,41310,35067,24214,26964,10127,11675,16498,31746,21684,15634,29279,45646,26768,29955,40615,10935,26255,43345,28478,18883,30602,28525,31293,38676,44950,34655,37849,48771,12971,28373,28937,28862,43551,48984,19433,22186,23889,45083,17223,45424,24057,16673,47709,39478,47985,11041,36287,29460,23689,45032,19690,10386,41439,15555,12547,10674,13290,27515,48092,26562,43988,25120,33856,39381,42164,40533,25331,35892,23360,31204,11275,35815,33699,22676,44558,42765,39003,13442,45669,20161,20655,10296,38115,40602,32606,29825,41827,34591,23014,29732,35793,19231,32064,14981,43494,21179,27626,40692,11842,21035,45286,49392,47106,17914,38778,25699,49558,26608,16151,39278,23198,37915,14856,28205,47456,10484,32440,23568,22517,21962,36693,10771,20026,25132,47715,30524,14567,15803,17086,49685,38277,20902,32972,37885,25556,28410,18440,22771,24087,22812,26655,35077,40543,38570,24340,17897,35656,19427,32216,49368,45233,17360,32185,37935,13111,31819,27516,34782,27089,19860,11375,33086,13625,36795,30822,42845,49019,42508,16356,20202,28165,36892,46495,22219,49117,21096,28807,12679,41699,28504,31023,47937,23491,38905,28952,21903,49123,26677,20940,20516,32521,38614,37315,22870,20334,10441,18712,23129,49295,30198,29232,42351,12321,24193,11039,11292,22587,42875,32109,43526,18866,23557,44022,20700,31005,14184,30860,49505,32696,41191,21102,48272,19713,11368,45943,10209,43255,39758,22720,14996,25372,42021,35801,42044,21548,33279,32098,14845,48684,14533,30471,33798,34398,32037,31783,37671,49229,46602,26971,18783,42215,22603,43971,14810,19174,23277,36120,27871,18932,29907,17479,14413,27596,26592,26876,32694,25844,32680,10081,44383,35023,11880,31017,35843,27553,11892,21836,18201,24871,18447,30716,37090,29712,24465,26009,27014,45398,49156,19342,12651,22329,11633,31471,16761,36438,30070,25781,17416,43968,47343,25796,31560,41552,19040,11454,22419,20441,32439,44752,20014,16353,46309,35260,41766,29882,17046,31592,17404,23339,29432,15341,20984,42939,46848,31753,12453,33556,17494,24304,12511,13362,12092,38882,22208,26184,37763,31638,44987,47214,29317,15834,44284,43441,23302,30310,20994,13923,45706,34646,16434,37339,31439,30647,20769,12947,12768,19022,31161,11715,48625,34057,37774,10957,42468,44726,25374,38953,37128,17207,46904,30468,39083,47193,49787,12594,35875,31265,27672,19128,33443,41811,11879,45021,14710,20144,24776,20370,37550,15131,43589,12641,44361,42594,42493,33724,36909,47776,28764,32700,24362,38846,44004,21423,10594,36843,44323,32934,46509,38430,45310,27404,24199,13965,37685,26027,27605,25522,44618,32570,47265,46449,17116,35547,45835,32367,16029,19383,49127,17721,14896,22456,10440,16483,36948,25840,23303,28735,12384,45714,15013,18293,27800,47503,16028,42016,16207,40240,48815,42598,13168,13381,46415,36510,47374,45604,27759,10252,10877,41640,17355,11689,42942,36212,40153,36622,31655,43545,25184,46695,29774,39662,23367,12439,38072,12352,29927,27062,21602,39344,36550,17359,43681,39623,33700,30779,45962,29553,13438,19415,44355,35357,21504,10158,35565,26298,11455,35496,23331,43717,44817,33949,38544,39788,14929,32612,33586,23056,19002,49426,30760,42769,49941,13988,48308,29386,43930,33373,41737,23305,33765,29731,47107,45705,29004,29506,35618,27439,25122,33694,38400,25314,17147,49615,11712,24372,32513,21736,29286,15357,40448,36186,41822,12054,40838,20474,41587,36368,32999,44796,12831,34582,12417,34533,13967,38176,22522,33145,17475,33296,22800,27196,25036,12569,38217,10546,27889,22617,18468,45783,27372,49872,43487,49125,47327,23374,37233,21879,16674,14489,46237,12520,14177,24691,14284,27106,19290,19722,14847,27017,29552,27831,23703,32522,47387,35985,38313,48493,38970,41739,21400,34654,23748,33299,42759,28049,45655,11141,10848,43886,44048,42952,15975,33148,19841,35754,10249,31524,23625,23031,13281,40118,15127,40046,22458,19867,17516,15317,32652,22806,37643,43677,26277,12056,27822,20565,11174,32693,20362,27053,40986,38539,49989,41785,35381,24059,32608,38408,28173,16163,29437,25002,45816,16997,17212,35705,33016,43322,37066,41085,46371,22188,44544,35696,49278,39911,20497,38517,19498,17752,17227,23084,16743,48908,26115,47019,25547,16317,31871,19636,28091,30087,37812,21346,17260,38307,10571,22531,36240,28951,35147,19069,36285,40011,28643,21660,21773,28356,10483,22090,27010,22063,37210,38299,35217,41309,41570,10286,31901,15649,43647,12532,14813,47950,25106,19731,11913,27540,16819,45530,22457,10326,13355,31152,24555,27414,35484,21349,28592,45609,36555,42711,30951,26644,49422,39877,26906,42126,31529,26822,28292,26201,18785,28129,45186,34114,25572,14978,42558,10574,35096,32456,40203,10711,46642,30378,13093,10988,38952,28151,28037,41042,22779,16545,26653,24084,24614,16737,11673,36919,18519,41567,27147,15258,40708,23341,33839,34071,45764,21019,28716,10517,25486,42414,40520,17484,18752,27446,39272,10939,11977,46124,21952,25148,19095,24369,28557,17623,30633,14360,43723,18308,41909,40727,47782,11347,49690,28843,34277,39955,24561,22494,46189,36986,29669,13458,44801,25402,45006,49618,39609,26243,30203,19888,38540,25041,11624,29292,22136,43174,17472,26792,20452,20074,47775,25958,10052,21235,20376,23614,17187,49439,23920,38208,31223,45394,12924,47508,33122,17482,32595,49443,43394,48383,15693,22548,39591,32821,40742,15961,36204,25059,31557,14718,44194,18391,26451,28682,26951,24514,17751,13239,14339,27025,32365,10589,49320,14965,14649,33622,41598,17820,27485,46319,24268,11280,45587,30012,28565,26825,12941,26033,11810,13445,44222,17766,39166,46323,25054,11844,36606,33726,27192,23278,41658,17660,19215,11114,17188,12441,12083,10284,18118,26475,48882,36639,11755,16525,23369,40359,40199,41183,38949,25233,26037,14495,22267,21255,49008,14444,38129,19620,22891,33133,41729,26058,28413,32600,11035,18343,13566,14959,20701,14803,31644,49552,17691,44572,10962,33348,36733,31465,15164,43779,47918,37670,25565,25189,29791,44353,48597,26471,30642,47980,12635,18877,20363,20645,31484,38351,12195,16078,14486,26979,44173,11798,12610,27906,46051,16897,13284,16021,49389,14485,13825,38158,39401,35900,23344,32159,26364,21231,18454,47742,22454,12906,15851,37783,36362,18613,48318,40453,24345,10055,12776,31275,10311,22521,45213,37974,39061,18005,13626,46553,22293,32251,45459,48033,24452,42494,42503,14418,43753,34704,42552,47901,15799,11240,14238,38604,45856,45448,19600,22674,23819,49305,41311,17272,48557,10993,11382,15539,19918,18027,31343,13747,16170,15847,13238,15195,47354,29207,11777,23447,32345,12017,17938,23385,46597,10543,16999,34185,27995,24927,25764,17113,41895,10582,13169,31138,36461,38333,13738,19441,30656,38461,27065,33063,29135,16441,37390,41941,40340,40464,19352,19881,23411,13211,41426,10338,48667,10745,27795,16308,49051,46096,28881,16684,43949,23437,19466,10228,43331,34164,35235,19207,38526,41064,19403,16386,36797,26284,18662,20394,22365,26196,10310,10595,20899,46018,18191,20010,39944,27933,35480,28633,25229,36782,21347,14935,19407,32630,15079,34901,45659,23281,44945,13492,21174,39301,38168,47530,26403,16303,18774,34005,26380,29630,42815,10178,27716,43963,39497,26499,24769,10684,30307,13271,11433,21254,38031,14742,19238,32724,24766,42954,26522,19653,47932,49912,22383,32619,34113,45595,44998,38701,21258,17129,27132,19216,29079,34080,18013,14099,16717,31692,47891,48722,22149,36670,13375,21535,46239,24604,46709,45070,12478,30437,22315,47443,22118,49282,15946,35926,21430,25020,49049,38445,30792,28019,22356,20694,46739,39902,21245,25957,37966,30434,16109,24364,31058,21519,12700,27858,35899,33270,30866,47081,19203,26633,30272,19060,12903,21799,34387,24081,14380,20828,30442,10381,39960,34771,22809,18474,41241,42980,48591,34263,27888,42334,10231,35939,38873,19783,34281,18491,37243,23988,46676,46153,41090,37767,17488,20310,49064,14480,20541,33837,45003,36546,21264,42198,33888,34111,46462,24261,49830,18880,18192,32015,14817,29674,48643,35438,17474,27328,44919,37741,43694,12557,11205,22660,49668,10527,44651,46272,20882,15627,44555,28517,45147,22892,41830,40506,47434,23304,10641,33735,47676,47215,19751,15027,32857,46069,42724,21319,18649,37632,12069,16371,14988,41595,26297,22040,16411,15128,40368,14524,46427,11332,41078,31521,31670,27863,44863,43260,35952,17778,17877,44344,31688,11592,36231,11229,46393,44852,38599,26664,30617,44042,23895,16286,40620,49760,28855,24920,42509,30611,45884,46266,14224,35338,42144,13110,20353,27763,12617,27107,22505,31555,30324,38735,37141,38715,27338,33743,18890,29514,27512,26377,14401,19169,42792,44768,14392,17588,33788,25051,46316,13569,13749,22514,14598,43538,47187,27440,11248,47173,26175,26014,43851,43576,49828,48744,31294,13739,24830,44364,11750,16404,47812,34451,32120,19156,37631,49940,15015,29734,29722,24264,39998,35127,24494,26599,41644,25686,27352,35595,18438,20339,21370,31902,41594,45226,39151,41211,37098,27241,19856,39489,30251,46744,18511,36690,32118,39598,12508,14758,33191,43597,47484,43534,13907,34810,27654,20917,33242,43616,45013,41403,15830,36539,48368,19166,33672,17549,14653,43692,21173,30709,44715,39886,44830,13236,35441,14499,19552,24112,21557,17681,35605,12780,10409,35356,40066,44265,35651,27240,37231,38871,35208,15963,44859,20125,28903,46008,41758,46860,39068,15446,37384,47964,20311,15871,27825,16567,16605,21490,40343,13087,31787,48350,30923,49251,42443,29826,31997,33059,16322,16500,37579,20629,16131,34149,43640,46784,11388,21243,39856,17273,24115,34156,16176,11050,28796,24787,45847,41563,45365,39411,45593,31682,45475,13713,36730,29218,14966,39172,41534,39920,47273,36585,26111,47267,42780,30678,18846,29823,45406,41353,18307,17050,39644,39809,47194,32800,44795,47421,33887,28821,35617,21284,40399,31583,29786,11971,14571,31534,13484,16327,31436,32891,47254,34382,48374,36069,11003,36369,29445,16315,20503,23626,27149,33106,35306,26182,40074,10734,28239,46653,13386,10696,19042,13024,14572,18806,11119,39470,17955,27972,27114,12211,17445,15644,46473,41819,20631,22933,34266,13495,15110,18948,22554,33614,40539,37410,11283,39798,26824,23923,19118,31303,47624,30858,49913,29168,40790,19915,32316,22989,25863,29459,46889,45505,18518,14665,36100,20823,17669,46503,38920,31409,12880,27476,31115,48731,19063,43225,38432,31572,11491,27088,45473,33283,14734,24680,43827,17941,19190,20378,17639,45412,19598,18301,31805,14263,16197,23886,20708,45054,34148,30805,28497,11025,22493,43392,45344,40538,34316,47915,33629,24595,12239,47092,13451,46615,20742,46990,10320,18350,24590,30915,21345,39506,18508,39923,25674,47381,27866,14681,19013,41839,46089,26330,48397,41130,28600,22686,38163,14549,28971,45953,18974,39148,13798,25330,23181,35972,43423,45289,31881,39628,43998,12974,46945,32827,10205,19670,25261,39675,43907,26581,46108,26029,46410,24225,12804,28914,35851,48936,13519,40500,20523,36667,12910,49490,24384,35443,33488,27104,26141,38249,12291,24858,40923,46753,19908,30020,35675,21029,47426,49411,39288,47357,30919,18912,27789,12528,42816,10677,43058,20361,45843,48535,43982,23745,11007,23470,35838,43801,21814,25499,17861,48485,22575,17707,18218,12027,48055,18736,27269,35387,44766,27391,28871,45779,36179,18590,11103,11067,41236,39736,12150,47348,41793,25648,28647,12683,29750,38560,39452,25537,46526,35173,38114,46639,14855,16559,24682,45177,23388,29952,23313,31848,15219,19510,33156,14545,15683,47111,29620,31545,44097,15385,34750,38480,17637,30824,12235,12614,36731,25035,27074,31552,49933,33332,14076,48436,39393,16426,42425,28299,18550,38703,28655,44984,21228,30145,47701,28673,24390,42234,10884,49929,20443,49656,13037,10092,42768,25026,16582,48403,21031,20777,28518,49969,46538,44515,19307,31205,21713,16433,18286,22652,44295,34583,20092,10125,11615,47353,34637,39051,43388,28926,30600,23977,47832,23639,21197,42814,20271,29062,22381,31430,20258,11803,25087,47221,28119,14687,38134,35751,10975,45107,37973,29536,17485,20309,21516,48997,46031,23417,18424,28223,22808,30772,39802,35973,13788,27020,38126,24260,28234,37702,32202,32479,44028,32621,44220,39322,34459,32101,49471,35085,13906,24060,15712,48082,28411,34126,46664,35020,20372,49521,25864,18682,48868,39570,16060,21498,20558,48450,23351,13260,35883,48911,47868,47088,10875,44746,31618,42535,40166,42483,41222,49873,45131,20552,13328,26962,15097,45889,34338,29836,28614,17028,36107,16472,26585,46570,28798,29903,35708,42591,48045,13309,25202,32020,17731,29510,45615,12628,48947,25758,25893,46579,24958,22979,39941,35347,16431,19781,31041,42857,25985,33541,42090,44986,47618,21016,46856,24086,11418,44176,34978,33773,23033,44502,39000,47945,32610,26641,30702,32002,49700,18501,31857,15526,13279,30682,43841,36739,44252,13117,29458,10554,39735,34784,45897,10201,39419,21971,20436,37248,14851,30296,22310,41763,10977,26593,19935,48739,21589,33476,27304,32462,30303,45594,19055,16216,22299,11362,14482,47849,27593,34429,15108,32210,21805,23158,36048,32336,27436,48340,40612,23487,48555,14258,40071,15155,18195,42958,25663,28838,39223,41878,15068,27638,30201,13877,24782,32388,38293,20587,43725,38421,19154,42719,38818,34929,30336,40634,20774,35536,28987,43643,35554,28028,18156,19442,29681,33777,31301,15785,44697,19680,30325,45804,22846,46378,19862,29512,18204,48433,47235,43880,42561,38704,26308,13817,29884,13088,14178,21489,37277,14358,27450,49566,11022,23874,22268,44273,10499,32019,31031,15408,41955,46797,28408,42330,40329,42920,30237,12482,43602,11814,42107,33849,14275,35049,16188,45704,46723,10444,40319,14011,41631,41141,24067,23366,47418,17676,40055,32563,21452,40712,39097,19786,47156,22718,11360,24178,49243,34606,11923,24407,16951,24559,49310,35987,21532,20180,33003,23438,48576,29902,30035,11437,39553,28662,10834,35056,44641,48425,17308,36499,48467,46374,40635,28921,18016,44946,25543,39163,41317,38801,38374,47752,19311,46577,44835,29916,46702,13493,36355,23122,27526,12205,49764,10755,36590,16469,41114,21034,34491,41246,37798,34871,14667,33655,25227,32001,22993,12271,30786,37515,44090,15531,41828,15321,48800,46270,40331,46721,25409,40746,40928,25888,30107,44077,45449,18245,13996,35800,42644,22180,24095,13890,16539,20402,29599,32463,37495,18713,13467,40346,46262,32861,20459,10225,45045,38694,18033,35132,33997,14603,42333,31214,34417,31562,39135,46212,17686,12258,15890,10417,18683,42775,35089,10114,21882,30075,19996,14622,27143,25062,26410,34789,13714,40804,20910,20856,42180,27890,25959,11151,34925,28520,45300,20866,44686,46040,15472,44885};

        Arrays.sort(columnB);
        for(int i=0; i < columnB.length; i++){
            int[] tuple = {columnB[i], i+1500};
            S.add(tuple);
        }
        System.out.println("Saved data for Relation S in Virtual Disk");

        int noOfBlocks = columnB.length / 8;
        for(int i=0; i < noOfBlocks; i++)
        {
            int startingIndex = i*8;
            SBlocks.add(S.subList(startingIndex, startingIndex+8));
        }
    }

    public void generateRelationRWith1000Tuples()
    {
        int[] columnB = {12253,16171,44197,10909,10341,30450,12579,23355,18324,49985,49150,43726,19528,14696,47108,32668,38888,49452,17436,16090,38306,32232,22194,39808,24356,43929,32480,11486,22635,49067,15756,30340,27683,43306,43300,22238,47388,21043,33405,19902,33475,36445,19496,32351,14525,24147,15797,13546,25397,17239,45205,47577,24299,44619,34725,12609,36809,14633,49018,35202,44628,40181,17190,49213,45790,15388,12229,15466,22075,44218,11506,22814,14993,44780,13291,23970,23471,44754,11494,27460,20757,20434,42529,16949,45361,12042,33759,42693,17799,35734,36426,21943,29740,39176,20814,21078,10337,41461,22620,47643,46398,49743,10031,29895,41825,48787,11052,24255,48527,26747,48888,23495,18038,44748,21765,22836,11172,15372,46125,33453,24129,19885,32182,16960,41418,11661,37785,46317,35264,27547,46598,32985,22201,22072,42645,24654,49763,39017,16107,11983,17798,38919,40499,16911,20217,38954,24451,38758,43718,29441,28575,44066,19292,49432,46961,36808,44999,41706,39586,27317,38033,31740,46412,13568,34521,40335,47663,30768,25853,19173,32030,46144,18576,42078,47539,13705,38910,27368,16849,25580,39196,31710,27473,38822,11226,23289,44743,42539,13100,22396,26494,45351,42282,13560,45239,26378,29271,15188,14594,28612,11159,15019,43489,27840,28289,46382,47968,45052,45094,35242,40084,28300,20736,16986,47208,25682,14395,36394,45662,44351,43734,43399,36862,46665,31391,35115,49639,26275,18493,23541,17700,30743,20908,47084,36321,30898,12287,26249,20938,34612,10736,13582,19718,24011,33352,47902,10533,31144,49386,36896,15828,48201,32126,19313,11891,13314,14135,41375,32632,20445,33309,11483,33536,38929,41174,40690,49276,32256,12915,39775,19720,36261,49584,12179,35503,31492,20395,29238,22460,44713,17169,29037,24434,22107,20366,22586,49987,20551,13341,14175,16117,15142,12414,28148,32784,12550,44511,12234,15156,18957,45019,15193,26021,49560,22117,22999,30614,14351,38988,14211,28990,32699,49075,11398,47848,40645,19844,49356,49453,37441,10269,37675,16454,40521,47850,29577,21989,41132,29095,22856,22277,14678,47009,42677,36031,10681,28908,45043,23997,46133,41862,30701,29594,15736,12506,42533,31485,19236,49554,47122,28040,48695,35211,45367,15401,40022,43147,48974,20505,41538,16221,15761,17954,30460,36868,22690,12192,14904,43600,33281,32684,18302,19669,10905,14035,13525,31035,48631,48894,46768,31111,46902,48705,18684,30284,49744,19745,16892,19582,35763,18437,46921,34373,48458,30510,46601,47233,46386,18548,44693,43422,27005,14737,47495,27580,34658,40313,40726,15699,11815,39996,13570,24705,49738,46523,46063,13078,14435,15742,25634,37665,14519,38746,45940,29109,32419,22485,20490,45422,43758,32344,40576,39784,48191,40308,48590,41956,35204,20116,14883,17733,17537,40741,36206,38117,31218,22434,47023,46539,43444,18030,40601,43520,29116,48348,19251,38507,46831,28830,23391,22875,10709,41460,13073,42843,18086,38534,37407,34262,38863,36722,37698,35374,11727,38470,23395,48900,14408,11516,10017,31075,26386,27226,19753,49119,22324,11029,34360,12024,21575,43852,22236,39556,38789,40641,46188,30525,24898,16680,45270,21726,47391,32659,27204,34191,32848,39827,11142,40269,24223,27658,48265,17294,11270,21701,13830,47258,16373,14676,45700,17107,38883,11219,29526,20350,16088,45994,19547,37469,47109,36479,17155,29975,44964,34744,28842,33971,28740,44596,19826,25705,48212,37584,28060,32832,40417,20479,43972,23799,40611,40605,48430,17123,30337,42701,41893,40363,20965,43312,49623,11613,35231,24733,11028,17981,17195,28980,46955,14754,40879,29631,14736,13015,23981,45506,33973,40390,49721,16180,42853,49613,10758,45418,18826,37009,12178,35867,48587,15704,20095,18563,19692,36105,31108,34882,18465,47731,21800,39027,33679,42790,13003,33413,44388,35444,41107,14440,44136,31866,17903,43644,36152,24557,19848,34747,17039,47390,44548,40505,49970,40463,33900,40648,34739,23172,18263,29792,26325,32080,49025,43361,44837,41753,24715,49655,28966,39949,27015,25362,15337,49024,16936,19656,39186,38428,17441,10540,47520,47382,29622,29230,49175,41495,35691,18525,38435,45020,34372,16952,26956,12342,41553,12259,34286,32951,28956,32707,43051,32236,41683,40275,32873,19602,46162,26047,17548,18516,13356,49151,10342,40917,44979,45115,33128,42130,24413,15545,45624,16488,28780,32477,49166,42349,34161,26755,47780,13298,14201,48690,19980,39939,49597,24754,24256,48193,30655,49671,48956,28132,11596,40968,25916,24405,32291,47038,47656,19794,34523,24600,24035,48579,34649,33584,24997,49965,15346,15702,23732,49060,45654,35947,15012,38177,27938,35053,18418,24486,15816,49660,43702,33825,16729,26752,30461,16258,33670,35433,36932,33237,11990,21821,12303,21281,35788,21416,32010,29227,20642,10078,22931,29561,40876,26426,11417,40326,18640,45887,20860,29839,49325,12221,10626,29854,46719,21375,35501,39228,10317,48426,44898,15942,41626,16758,26904,23073,39427,40658,34276,40826,13924,36715,48573,48164,47875,35514,10470,31713,26874,13744,19265,30649,18861,23804,40015,33984,17462,47612,10551,21081,18150,10471,15746,31594,35284,26828,35818,31327,26751,45280,15801,33499,44759,14698,11160,22122,37693,47339,32581,24085,13851,42482,17364,46976,36975,37487,33749,45041,20614,11534,38113,44359,48165,21559,24518,19187,18215,27815,44458,42208,23271,40494,19355,37373,34172,38554,21068,44623,29633,12730,23891,44602,22402,20644,30306,13899,32627,10155,15686,17319,45870,40141,27484,39494,44800,28607,43188,17395,41873,47892,40445,39107,27546,40794,25563,32897,15626,32298,39658,23940,47408,45551,44911,23338,45458,27448,31047,18998,20802,22098,43450,39283,21338,24444,32257,18092,31683,39762,39382,33925,43185,38609,25048,20941,39442,22045,43549,16534,30990,21212,19016,27393,35157,21323,31798,30875,23390,29343,11605,42634,23054,35418,14715,14659,16909,41505,43095,37190,14941,26679,38440,24622,49948,29678,13719,40245,21244,39749,42301,40582,45307,19021,12515,38057,31812,47587,44125,37548,28885,29481,24900,37755,46098,32506,43858,40504,25521,16099,26414,37451,23335,48171,46914,46563,16815,18633,11322,33058,37831,10938,35287,15969,10854,19702,47405,18734,39750,45283,35086,32114,21495,14295,13883,43765,31828,29621,32060,48784,39350,37004,40068};

        Arrays.sort(columnB);
        for(int i=0; i < columnB.length; i++){
            int[] tuple = {i+10000, columnB[i]};
            R.add(tuple);
        }
        System.out.println("Saved data for Relation R with 1000 tuples in Virtual Disk");

        int noOfBlocks = columnB.length / 8;
        for(int i=0; i < noOfBlocks; i++)
        {
            int startingIndex = i*8;
            RBlocks.add(R.subList(startingIndex, startingIndex+8));
        }
        readDataFromDisk(72, 1000);
    }

    public void generateRelationRWith1200Tuples()
    {
        int[] columnB = {23355,22194,24356,22635,27683,22238,21043,24147,25397,24299,22075,22814,23970,23471,27460,20757,20434,21943,29740,20814,21078,22620,29895,24255,26747,23495,21765,22836,24129,27547,22201,22072,24654,20217,24451,29441,28575,27317,25853,25580,27473,23289,22396,26494,26378,29271,28612,27840,28289,28300,20736,25682,26275,23541,20908,26249,20938,24011,20445,20395,29238,22460,29037,24434,22107,20366,22586,20551,28148,26021,22117,22999,28990,29577,21989,29095,22856,22277,28908,23997,29594,28040,20505,22690,27005,27580,24705,25634,29109,22485,20490,22434,29116,28830,23391,22875,23395,26386,27226,22324,21575,22236,24898,21726,27204,24223,27658,21701,29526,20350,29975,28842,28740,25705,28060,20479,23799,24733,28980,29631,23981,20095,21800,24557,23172,29792,26325,27015,25362,27815,23271,25525,20475,27649,28693,22072,20043,20914,26935,21150,26827,26367,26054,21024,29318,22646,25688,24268,20071,23860,20911,28804,23309,20674,27461,28754,26159,22632,21012,22006,21871,28362,22369,25230,21722,22624,23750,24865,21748,24186,29532,26125,21769,24034,29002,26261,21458,20017,27458,29130,27962,21696,21746,29711,26494,26847,26677,28287,25406,29745,29070,21448,22281,29056,28957,25971,26727,24990,24972,20453,26450,23151,20100,28541,26418,29640,28072,24551,22306,26040,22984,29483,26982,22590,22605,23435,28694,28664,28883,20389,25012,20788,21383,25624,27037,29391,28483,22531,28797,27804,27529,22307,22263,27353,21301,24472,26689,28876,24301,24738,25239,21145,26679,20600,23229,22730,21710,29804,20179,28374,24587,21312,25685,25392,26331,28833,27300,24603,29428,23727,22716,20750,25687,28328,25358,29928,26694,21629,25502,29382,21589,28999,28008,20723,26973,27841,28160,23725,26312,29053,28187,24379,23885,27725,27836,20478,23414,27702,22637,29885,29250,27598,28319,22461,22268,27139,26751,25733,29944,21241,25495,25923,24391,27528,22026,28891,20769,25553,20113,27750,24122,29577,22200,26345,21575,27772,26319,27433,26943,20867,21386,23356,25671,28167,28679,28289,21555,23961,27318,22549,26686,24196,27361,24241,29496,20155,29109,24081,24866,20215,26555,27028,25987,22645,20689,28257,29697,22836,22741,27587,22251,24715,25891,23164,25309,28695,25215,29256,22745,25818,22718,20122,26303,29952,21556,22163,24349,21955,29248,28488,20597,28607,26287,21927,29294,25630,22518,27238,24250,24852,27865,25129,22294,20822,28910,27435,26213,20006,24101,28166,28030,20854,26717,25434,24317,25078,28486,24449,21402,28275,23186,24051,28568,25445,21212,22125,26616,23462,22477,24805,24238,28923,27070,23827,25470,20758,22401,27619,27569,20974,22377,24718,29979,27211,22988,24055,21760,26046,26169,28898,26463,24521,23345,24010,24970,20154,22430,24358,26238,24821,20850,29171,21631,29137,29046,20167,28860,23189,21708,21297,26089,26821,21688,23323,26972,28613,28120,26743,24844,28846,28366,21608,20082,22909,26581,26152,26757,22315,26362,27178,29575,25220,22488,25768,22378,25003,28407,27751,28145,22861,26059,27698,26139,28987,27110,24630,26654,26129,26376,24784,26187,21715,23290,22203,24561,29272,22621,21135,28707,29945,22407,26620,20844,26085,24751,28480,23844,22336,26233,22617,24775,20690,21829,29764,29599,29441,28329,21640,27160,25390,27488,27629,21320,21452,28036,28420,29012,29549,26546,23331,22607,23901,27975,20180,28845,22667,27987,21717,27757,28604,22535,24764,22558,21474,26931,26587,28636,20266,26070,21426,28478,28194,24782,29772,25626,24416,22955,24867,23851,29306,28928,23368,24511,22868,21023,24390,26351,24324,26597,24667,22743,28108,21868,27147,25568,23457,26712,25370,23303,21970,22700,26030,24204,24642,26132,20821,23214,25672,27440,27705,26522,22382,27490,24687,21214,20613,28443,27079,20441,20630,23010,25861,29138,29023,26197,26547,24794,27562,21689,28628,29987,20972,23109,29910,26917,23009,28386,27984,27542,21323,21193,24935,23975,28312,21753,21655,25259,28138,26004,20710,27371,25812,26074,29537,26924,22755,29177,29240,27916,25616,28218,26645,22612,28279,28595,23319,22044,23989,24558,23519,26247,28585,21496,20768,21925,21011,27368,20458,24145,24708,22541,25795,26256,27121,24409,27605,22885,24494,24211,28347,29518,28676,29650,21038,23852,20191,22362,27860,23756,20861,28490,28190,25252,25758,27246,23464,28932,24554,20576,23804,28814,23441,24566,22451,23482,28358,27254,29900,23569,27248,25007,21430,20288,29864,29068,29977,29036,26675,28855,24750,29774,27000,21590,27066,24767,22552,25684,29270,21266,29540,29220,23321,22654,28152,24469,22045,26660,24835,20083,27927,27784,23007,21108,26181,22104,29652,21576,26515,25306,26292,23040,22374,23722,28617,20124,29786,25625,24611,25639,29189,20757,28239,23599,27932,23308,26133,25317,23314,23534,24702,22260,21363,25112,23447,26882,28308,23828,20159,21073,23067,26050,23644,29688,25992,24295,27502,28687,21657,23042,20651,25235,20658,28936,25554,21938,28436,23310,26504,21499,24920,24323,25722,28178,24861,25943,23991,22243,21790,23131,29615,27904,22638,23585,23559,20959,25005,28254,22595,24370,24088,21817,22924,26495,28733,24666,23925,22919,26214,27265,28967,23651,24733,29312,21883,23866,23731,27258,27516,27617,29425,21273,22840,22335,29524,22492,20275,21863,28049,27005,20808,26934,25260,21123,22120,29188,25348,24938,29304,26318,21469,21271,22720,23459,23971,23132,21964,27697,21776,28391,20805,29630,29039,29940,29851,26629,21694,21635,24948,29054,27586,26322,22768,21914,25480,24123,26317,20495,24300,25978,28354,29037,23415,20352,24774,25436,21153,25353,24726,23286,21623,26100,24632,28124,20138,22205,28331,20329,21256,26655,23490,23262,20253,26185,25167,26297,26380,23744,27730,26375,20343,24807,25690,22235,28325,27477,21479,20084,22697,22434,22298,22643,28061,21197,23853,27345,29974,25022,27738,29464,29214,27132,24158,29274,26349,25851,29115,25958,25599,21188,21644,28573,21232,22783,28515,25273,26428,29758,29828,24800,20654,20426,20491,23380,25362,24439,22950,25263,26824,28346,21791,26572,20262,22474,27478,24539,27540,24917,21027,25957,22642,21992,24838,25677,20700,29649,25180,25603,22752,23100,25474,25830,28290,21484,20809,25456,24923,24691,27592,26693,27096,25329,27330,28225,25419,23854,22283,23874,26880,24199,21429,22484,24814,20205,24600,29580,20450,27720,23956,23706,22105,26906,25529,21926,21488,24739,22767,22906,22510,20391,25537,23628,26369,29479,24017,27019,27925,26514,21675,28161,23649,29257,29432,29663,26518,24759,23184,24478,29585,29172,24415,27965,27888,29372,29689,29990,28453,29227,27418,26290,28886,22769,25195,25703,24601,25455,25789,28107,23856,25560,26114,21081,23965,21632,24420,23220,26799,24967,29533,27144,25387,24210,23166,21282,22554,22130,24442,21370,27768,22731,23453,22986,28176,21078,22050,28782,22207,24595,24498,20559,26905,29478,22232,28954,25906,24886,22433,28229,23208,24797,27821,22967,20189,22487,24099,25997,22949,22390,27627,26608,20832,25199,26347,22437,25052,29342,21194,24597,25954,24221,24493,26254,27650,23547,22224,28316,22265,27244,25490,27684,29854,24422,24929,28739,29271,20521,23328,29553,26104,27394,25751,21945,25100,28914,27315,25646,28837,21762,26225,23145,24134,20046,21852,26922,29572,29239,21384,24445,26845,25822,24504,22757,27020,27463,29482,26867,25897,28760,27083,22867,22109,26203,26911,21860,21806,23055,26745,29578,25860,26888,23982,27818,24676,25145,26762,20254,25940,29158,21582,27397,28843,21803,29146,20753,28460,26499,21658,28553,28851,27914,29408};

        Arrays.sort(columnB);
        R = new ArrayList<>();
        RBuckets = new ArrayList<>();
        SBuckets = new ArrayList<>();

        for(int i=0; i < columnB.length; i++){
            int[] tuple = {i+20000, columnB[i]};
            R.add(tuple);
        }
        System.out.println();
        System.out.println("Saved data for Relation R with 1200 tuples in Virtual Disk");

        int noOfBlocks = columnB.length / 8;
        for(int i=0; i < noOfBlocks; i++)
        {
            int startingIndex = i*8;
            RBlocks.add(R.subList(startingIndex, startingIndex+8));
        }
        readDataFromDisk(80, 1200);
    }

    public void readDataFromDisk(int bucketSizeForR, int noOfTuplesOfR)
    {
        System.out.println();
        System.out.println("Reading Data from Virtual Disk to form buckets");
        //Buckets for relation S
        int noOfBucketsForS = (int) Math.ceil((double)S.size()/336);
        for (int i=0; i < noOfBucketsForS; i++){
            int startingIndex = i*336;
            int endingIndex = startingIndex+336;
            if(endingIndex > 5000){
                endingIndex = 5000;
            }
            SBuckets.add(S.subList(startingIndex, endingIndex));
        }
        System.out.println("Saved data for Relation S with 5000 tuples in buckets with approximately 42 blocks each");

        //Buckets for Relation R
        int bucketRIndex = 0;
        List<int[]> finalBucket = new ArrayList<>();
        List<int[]> bucket = new ArrayList<>();
        for(int i = 0; i< SBuckets.size(); i++)
        {
            int minRange = SBuckets.get(i).get(0)[0];
            int maxRange = SBuckets.get(i).get(SBuckets.get(i).size()-1)[0];

            for(int j=0; j < R.size(); j++)
            {
                if(R.get(j)[1] >= minRange && R.get(j)[1] <= maxRange){
                    if(bucketRIndex < bucketSizeForR){
                        bucket.add(R.get(j));
                        bucketRIndex++;
                    }
                    else if(bucketRIndex == bucketSizeForR){
                        RBuckets.add(bucket);
                        bucketRIndex = 0;
                        bucket = new ArrayList<>();
                    }
                }
            }
            finalBucket = bucket;
        }
        if(bucketRIndex > 0)
        {
            RBuckets.add(finalBucket);
        }
        if(noOfTuplesOfR == 1000){
            System.out.println("Saved data for Relation R with 1000 tuples in buckets with approximately 9 blocks each");
            System.out.println();
        }
        else{
            System.out.println("Saved data for Relation R with 1200 tuples in buckets with approximately 10 blocks each");
            System.out.println();
        }

        joinBuckets(noOfTuplesOfR);
    }

    public void joinBuckets(int noOfTuplesOfR)
    {
        System.out.println();
        for(int i=0; i < RBuckets.size(); i++)
        {
            for(int j=0; j < RBuckets.get(i).size(); j++)
            {
                for(int k=0; k < SBuckets.get(i).size(); k++)
                {
                    if(RBuckets.get(i).get(j)[1] == SBuckets.get(i).get(k)[0])
                    {
                        int[] newTuple = {RBuckets.get(i).get(j)[0], RBuckets.get(i).get(j)[1], SBuckets.get(i).get(k)[1]};
                        finalRelation.add(newTuple);
                    }
                }
            }
        }

        System.out.println("Finished Join Operation!");

        if(noOfTuplesOfR == 1200)
        {
            System.out.println("Final Relation after the Join Operation is as follows - ");
            for(int i=0; i < finalRelation.size(); i++)
            {
                System.out.print("{ ");
                System.out.print(finalRelation.get(i)[0] + ", " + finalRelation.get(i)[1] + ", " + finalRelation.get(i)[2]);
                System.out.println(" }");
            }
            System.out.println();
            System.out.println("Total no of Disk I/O's for Relation R with 1200 tuples are: " + 2325);
        }
        else{
            System.out.println("Total no of Disk I/O's for Relation R with 1000 tuples are: " + 2250);
        }
    }

    public void getSpecificTuples(int[] columnB)
    {
        System.out.println();
        System.out.println("Tuples based on the 20 B values - ");
        for(int i=0; i < columnB.length; i++)
        {
            for(int j=0; j < finalRelation.size(); j++)
            {
                if(columnB[i] == finalRelation.get(j)[1])
                {
                    System.out.print("{ ");
                    System.out.print(finalRelation.get(j)[0] + ", " + finalRelation.get(j)[1] + ", " + finalRelation.get(j)[2]);
                    System.out.println(" }");

                }
            }
        }
    }

}
